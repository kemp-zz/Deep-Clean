name: Deep Clean


on:
  workflow_dispatch:
  schedule:
    - cron: 0 0 * * * # 每天凌晨执行一次

jobs:
  env-check:
    runs-on: ubuntu-latest
    steps:
      - name: 环境预检
        run: |
          echo "▂▂▂▂▂▂▂▂ 存储诊断 ▂▂▂▂▂▂▂▂"
          df -h /
          echo "▂▂▂▂▂▂▂▂ 初始状态 ▂▂▂▂▂▂▂▂"

      - name: 查询固化的apt和pip包
        run: |
          echo "▂▂▂▂▂▂▂▂ 查询固化的apt和pip包 ▂▂▂▂▂▂▂▂"
          
          # 查询固化的apt包
          echo "固化的apt包:"
          dpkg -l | grep -v "ii\|rc" | awk '{print $2}'
          
          # 查询固化的pip包
          echo "固化的pip包:"
          pip list --format=columns
